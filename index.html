<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible">
        <title>Personal Expense App</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link
			rel="stylesheet"
			href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
			integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T"
			crossorigin="anonymous"
        />
        <script
			defer
			src="https://use.fontawesome.com/releases/v5.7.2/js/all.js"
			integrity="sha384-0pzryjIRos8mFBWMzSSZApWtPl/5++eIfzYmTgBBmXYdhvxPc+XcFEk+zJwDgWbP"
            crossorigin="anonymous">
        </script>

    </head>
    <body>
            <nav class="navbar navbar-dark bg-dark">
                    <span class="navbar-brand mb-0 h1">Expenses</span>
                </nav>
                <div class="container-fluid bg-light" style="min-height: 100vh; box-shadow: 5px 5px 10px #888888">
                    <div class="container">
                                <div class="jumbotron mt-4">
                                        <h3 id="headingTotal" ></h3>
                                    <div class="input-group mb-3">
                                  
                                         <div class="input-group-prepend">
                                             <span class="input-group-text" id="spent in rupee" style="box-shadow: 5px 5px 10px #888888">â‚¹</span>
                                         </div>
                                         <input
                                            id="inputAmount"
                                            type="text"
                                            class="form-control"
                                            placeholder="Amount spent"
                                            aria-label="Amount spent"
                                            aria-describedby="spent in rupee"
                                            autocomplete="off"
                                            style="box-shadow: 5px 5px 10px #888888"
                                         />
                                    </div>

                                <div class="input-group mb-3" >
                                        <div class="input-group-prepend">
                                         <span class="input-group-text" id="spent at" style="box-shadow: 5px 5px 10px #888888">@</span>
                                         </div>
                                        <input
                                            id="inputDesc"
                                            type="text"
                                            class="form-control"
                                            placeholder="Spent On"
                                            aria-label="spent On"
                                            aria-describedby="spent at"
                                            autocomplete="off"
                                            style="box-shadow: 5px 5px 10px #888888"
                                        />
                                    
                                </div>
                                            <div class="input-group-append" style="align-items: center; justify-content: center">
                                             <button class="btn btn-outline-secondary btn-sm btn-block" type="button" id="btnAddExpense" style="box-shadow: 5px 5px 10px #888888 " >ADD</button>
                                        </div> 
                            </div>
        <div>
                <ul class="list-group" id="expenseTable">
                   
                </ul>
            </div>
        <div id="expenseTable"></div>
                    </div>
        <script>
                // get the heading element
                const headingEl = document.querySelector("#headingTotal");

                // get the amount element 
                const inputElement = document.querySelector("#inputAmount");

                // get the description element
                const inputDescEl = document.querySelector("#inputDesc");

                // get the Table element
                const expenseTableEl = document.querySelector("#expenseTable");

                // init value of expense to 0
                let totalExpense = 0;

                // set the heading element
                headingEl.textContent = totalExpense;

                // create an array to hold all expenses
                const allExpenses = []

                // on button Click add inputAount to totalExpense
                function addExpenseToTotal(){
                    const now = new Date();

                    // create an empty expense object
                    const expenseItem = {}
                    // read value from inputAmount
                    
                    const textAmount = inputElement.value;
                    
                    // convert value to number
                    const expense = parseInt(textAmount, 10);

                    // read the expense description
                    const textDesc = inputDescEl.value;

                    //add the expenses to the object
                    expenseItem.desc = textDesc;
                    expenseItem.amount = expense;
                    expenseItem.moment = new Date();
                    allExpenses.push(expenseItem);  
                    
                    console.table(allExpenses)  

                    // onButtonClick add inputAmount to totalExpense
                    totalExpense = totalExpense + expense;
                    
                    // set the heading element to totalExpense
                    headingEl.textContent = `Total Expenditure = ${totalExpense}`;
                    
                    // // Show the table here
                    // const data1 = allExpenses[0];
                    // const data2 = allExpenses[1];

                    // const data1Text = ` ${data1.amount} ::  ${data1.desc}`;
                    // const data2Text = ` ${data2.amount} ::  ${data2.desc}`;

                    // const tableText = `
                    //     <div>${data1Text}</div>
                    //     <div>${data2Text} </div>
                    // `
                    const allExpenseHTML = allExpenses.map(expense =>
                        createListItem(expense));  //expense object has both desc and amount therefore just pass expense
                        

                    const joinedAllExpenseHTML = allExpenseHTML.join("");
                    // textContent does not regard the html tags but takes them as string 
                    // expensetable.textContent = tableText;
                    // to make the html tags effective we use innerHTML
                    expenseTableEl.innerHTML = joinedAllExpenseHTML;
                }

                //get button element
                const element = document.querySelector("#btnAddExpense");
                // console.log(element);

                //listen to click event
                element.addEventListener("click", addExpenseToTotal, false);
                
                // View Layer
                function createListItem({desc, amount, moment}){
                     return `<li class="list-group-item d-flex justify-content-between">
							<div class="d-flex flex-column">
                                    ${desc}
                                <small class="text-muted">${moment.toLocaleDateString('en-US', {year:'numeric', month:'long', day:'numeric'})}</small>
							</div>
							<div>
								<span class="px-5">
                                        ${amount}
								</span>
								<button type="button" class="btn btn-outline-danger btn-sm">
									<i class="fa fa-times-circle" aria-hidden="true"></i>
								</button>
							</div>
						</li>`
                }

                
        </script>
    </body>
   
</html>
